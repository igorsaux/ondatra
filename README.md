# ONDATRA

Эмулятор 32-битного процессора RISC-V.

## Возможности

- Compile-time переключение возможностей эмулятора - поддержка расширении, PMP, проверки и т.д.
- Привилегированный режим с U и M уровнями.

### Поддерживаемые расширения

| Расширение | Описание |
|------------|----------|
| RV32I | Базовый целочисленный набор инструкций |
| M | Умножение и деление |
| F | Вещественные числа одинарной точности (float32) |
| D | Вещественные числа двойной точности (float64) |
| Zicsr | Доступ к регистрам состояния и контроля |
| Zifencei | Синхронизация кэша инструкций |
| Zba | Генерация адресов (sh1add, sh2add, sh3add) |
| Zbb | Базовые битовые операции |
| Zicntr | Базовые счетчики производительности (cycle, time, instret) |

## Бенчмарки

MacBook Air M3

```sh
+--------------------------------------fibbonacci_compilant---------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   1962   |    14us    |    22us    |  14.566us  |    15us    |    0.66    |  134.7   |  140.1   |
+-------------------------------------------------------------------------------------------------+


+-----------------------------------------fibbonacci_fast-----------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   1962   |    7us     |    20us    |  7.301us   |    7us     |    0.65    |  268.7   |  280.3   |
+-------------------------------------------------------------------------------------------------+


+------------------------------------floatMinMaxAbs_compilant-------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   2141   |    15us    |    44us    |  15.946us  |    16us    |    0.89    |  134.3   |  142.7   |
+-------------------------------------------------------------------------------------------------+


+---------------------------------------floatMinMaxAbs_fast---------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   2141   |    9us     |    28us    |  10.144us  |    10us    |    0.68    |  211.0   |  237.9   |
+-------------------------------------------------------------------------------------------------+


+------------------------------------floatArithmetic_compilant------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   1018   |    8us     |    18us    |  8.407us   |    8us     |    0.73    |  121.1   |  127.3   |
+-------------------------------------------------------------------------------------------------+


+--------------------------------------floatArithmetic_fast---------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   1018   |    4us     |    13us    |  5.028us   |    5us     |    0.44    |  202.4   |  254.5   |
+-------------------------------------------------------------------------------------------------+


+-------------------------------------floatSqrtFma_compilant--------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   416    |    3us     |    11us    |  3.234us   |    3us     |    0.50    |  128.6   |  138.7   |
+-------------------------------------------------------------------------------------------------+


+----------------------------------------floatSqrtFma_fast----------------------------------------+
|  instr   |    min     |    max     |    avg     |   median   |  std_dev   | MIPS avg | MIPS max |
|----------|------------|------------|------------|------------|------------|----------|----------|
|   416    |    1us     |    22us    |  1.975us   |    2us     |    0.61    |  210.6   |  416.0   |
+-------------------------------------------------------------------------------------------------+
```
